
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>Getting Started - Amazon EKS SSP Quickstart</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Amazon EKS SSP Quickstart" class="md-header__button md-logo" aria-label="Amazon EKS SSP Quickstart" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon EKS SSP Quickstart
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/aws-quickstart/quickstart-ssp-amazon-eks/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aws-quickstart/quickstart-ssp-amazon-eks
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Amazon EKS SSP Quickstart" class="md-nav__button md-logo" aria-label="Amazon EKS SSP Quickstart" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Amazon EKS SSP Quickstart
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aws-quickstart/quickstart-ssp-amazon-eks/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aws-quickstart/quickstart-ssp-amazon-eks
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Getting Started
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-setup" class="md-nav__link">
    Project setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-a-blueprint-eks-cluster" class="md-nav__link">
    Deploy a Blueprint EKS Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onboard-a-team" class="md-nav__link">
    Onboard a Team
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-workloads-with-argocd" class="md-nav__link">
    Deploy workloads with ArgoCD
  </a>
  
    <nav class="md-nav" aria-label="Deploy workloads with ArgoCD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-argocd-cli" class="md-nav__link">
    Install ArgoCD CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposing-argocd" class="md-nav__link">
    Exposing ArgoCD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-into-argocd" class="md-nav__link">
    Logging Into ArgoCD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-workloads-to-your-cluster" class="md-nav__link">
    Deploy workloads to your cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-deployments" class="md-nav__link">
    Validate deployments.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../teams/" class="md-nav__link">
        Teams
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd/" class="md-nav__link">
        CI/CD
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cluster-management/" class="md-nav__link">
        Cluster Management
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../core-concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        AddOns
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AddOns" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          AddOns
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../addons/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../addons/cluster-autoscaler/" class="md-nav__link">
        Cluster Autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../addons/container-insights/" class="md-nav__link">
        Container Insights
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Cluster Providers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cluster Providers" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Cluster Providers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-providers/ec2-cluster-provider/" class="md-nav__link">
        EC2 Cluster Provider
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-providers/fargate-cluster-provider/" class="md-nav__link">
        Fargate Cluster Provider
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-providers/outpost-cluster-provider/" class="md-nav__link">
        Outpost Cluster Provider
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-setup" class="md-nav__link">
    Project setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-a-blueprint-eks-cluster" class="md-nav__link">
    Deploy a Blueprint EKS Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onboard-a-team" class="md-nav__link">
    Onboard a Team
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-workloads-with-argocd" class="md-nav__link">
    Deploy workloads with ArgoCD
  </a>
  
    <nav class="md-nav" aria-label="Deploy workloads with ArgoCD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-argocd-cli" class="md-nav__link">
    Install ArgoCD CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposing-argocd" class="md-nav__link">
    Exposing ArgoCD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-into-argocd" class="md-nav__link">
    Logging Into ArgoCD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-workloads-to-your-cluster" class="md-nav__link">
    Deploy workloads to your cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate-deployments" class="md-nav__link">
    Validate deployments.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-quickstart/quickstart-ssp-amazon-eks/edit/master/docs/getting-started.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h1>
<p>This getting started guide will walk you through setting up a new CDK project which leverages the <code>cdk-eks-blueprint</code> NPM module to deploy a simple SSP. </p>
<h2 id="project-setup">Project setup<a class="headerlink" href="#project-setup" title="Permanent link">&para;</a></h2>
<p>The quickstart leverages <a href="https://aws.amazon.com/cdk/">AWS Cloud Development Kit (CDK)</a>. Install CDK via the following.</p>
<div class="codehilite"><pre><span></span><code>npm install -g aws-cdk
</code></pre></div>

<p>Verify the installation.</p>
<div class="codehilite"><pre><span></span><code>cdk --version
</code></pre></div>

<p>Create a new <code>typescript</code> CDK project in an empty directory.</p>
<div class="codehilite"><pre><span></span><code>cdk init app --language typescript
</code></pre></div>

<p>Each combination of target account and region must be bootstrapped prior to deploying stacks.
Bootstrapping is an process of creating IAM roles and lambda functions that can execute some of the common CDK constructs.</p>
<p><a href="https://docs.aws.amazon.com/cdk/latest/guide/bootstrapping.html">Bootstrap</a> your environment with the following command. </p>
<div class="codehilite"><pre><span></span><code>cdk bootstrap aws://&lt;AWS_ACCOUNT_ID&gt;/&lt;AWS_REGION&gt;
</code></pre></div>

<h2 id="deploy-a-blueprint-eks-cluster">Deploy a Blueprint EKS Cluster<a class="headerlink" href="#deploy-a-blueprint-eks-cluster" title="Permanent link">&para;</a></h2>
<p>Install the <code>cdk-eks-blueprint</code> NPM package via the following.</p>
<div class="codehilite"><pre><span></span><code>npm i @shapirov/cdk-eks-blueprint
</code></pre></div>

<p>Replace the contents of <code>bin/&lt;your-main-file&gt;.ts</code> (where <code>your-main-file</code> by default is the name of the root project directory) with the following code. This code will deploy a new EKS Cluster and install the <code>ArgoCD</code> addon.</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span> <span class="s1">&#39;source-map-support/register&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">cdk</span> <span class="k">from</span> <span class="s1">&#39;@aws-cdk/core&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">EksBlueprint</span><span class="p">,</span> <span class="nx">AddOns</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">&#39;@shapirov/cdk-eks-blueprint&#39;</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">addOns</span>: <span class="kt">Array</span><span class="o">&lt;</span><span class="nx">ClusterAddOn</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[</span>
  <span class="k">new</span> <span class="nx">AddOns</span><span class="p">.</span><span class="nx">ArgoCDAddOn</span><span class="p">,</span>
<span class="p">];</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cdk</span><span class="p">.</span><span class="nx">App</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;east-test-1&#39;</span><span class="p">,</span> <span class="nx">addOns</span><span class="p">}</span>
<span class="k">new</span> <span class="nx">EksBlueprint</span><span class="p">(</span><span class="nx">app</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">env</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">account</span><span class="o">:</span> <span class="s1">&#39;XXXXXXXXXXXX&#39;</span><span class="p">,</span>
      <span class="nx">region</span><span class="o">:</span> <span class="s1">&#39;us-east-2&#39;</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div>

<p>Deploy the stack using the following command</p>
<div class="codehilite"><pre><span></span><code>cdk deploy
</code></pre></div>

<p>Congratulations! You have deployed your first EKS cluster with <code>cdk-eks-blueprint</code>.</p>
<h2 id="onboard-a-team">Onboard a Team<a class="headerlink" href="#onboard-a-team" title="Permanent link">&para;</a></h2>
<p>Now that we have our cluster deployed, it is time to onboard our first team. In its simplest form, a team is represented in a Kubernetes cluster by a namespace. In order to create a new team and namespace within your cluster do the following:</p>
<p>Create a new file called <code>team-awesome</code>.</p>
<div class="codehilite"><pre><span></span><code>touch team-awesome.tsx
</code></pre></div>

<p>Paste the following code the file. </p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ClusterInfo</span><span class="p">,</span> <span class="nx">ApplicationTeam</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">&#39;../../stacks/eks-blueprint-stack&#39;</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">TeamAwesome</span> <span class="k">extends</span> <span class="nx">ApplicationTeam</span> <span class="p">{</span>
    <span class="kr">constructor</span><span class="p">(</span><span class="nx">app</span>: <span class="kt">App</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">({</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;team-awesome&quot;</span><span class="p">,</span>
            <span class="nx">users</span><span class="o">:</span> <span class="p">[</span>
                <span class="k">new</span> <span class="nx">ArnPrincipal</span><span class="p">(</span><span class="sb">`arn:aws:iam::</span><span class="si">${</span><span class="nx">YOUR_IAM_ACCOUNT</span><span class="si">}</span><span class="sb">:user/user1`</span><span class="p">),</span>  
                <span class="k">new</span> <span class="nx">ArnPrincipal</span><span class="p">(</span><span class="sb">`arn:aws:iam::</span><span class="si">${</span><span class="nx">YOUR_IAM_ACCOUNT</span><span class="si">}</span><span class="sb">:user/user2`</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Replace the contents of <code>bin/main.tsx</code> with the following:</p>
<div class="codehilite"><pre><span></span><code><span class="k">import</span> <span class="s1">&#39;source-map-support/register&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">cdk</span> <span class="k">from</span> <span class="s1">&#39;@aws-cdk/core&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">EksBluepint</span><span class="p">,</span> <span class="nx">AddOns</span><span class="p">,</span> <span class="nx">Team</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">&#39;@shapirov/cdk-eks-blueprint&#39;</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">TeamAwesome</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">&#39;../teams/team-awesome&#39;</span>

<span class="kd">const</span> <span class="nx">addOns</span>: <span class="kt">Array</span><span class="o">&lt;</span><span class="nx">ClusterAddOn</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[</span>
  <span class="k">new</span> <span class="nx">AddOns</span><span class="p">.</span><span class="nx">ArgoCDAddOn</span><span class="p">,</span>
<span class="p">];</span>

<span class="kd">const</span> <span class="nx">teams</span>: <span class="kt">Array</span><span class="o">&lt;</span><span class="nx">Team</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[</span>
    <span class="k">new</span> <span class="nx">TeamAwesome</span>
<span class="p">]</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cdk</span><span class="p">.</span><span class="nx">App</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;east-test-1&#39;</span><span class="p">,</span> <span class="nx">addOns</span><span class="p">,</span> <span class="nx">teams</span><span class="p">}</span>
<span class="k">new</span> <span class="nx">EksBlueprint</span><span class="p">(</span><span class="nx">app</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">env</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">account</span><span class="o">:</span> <span class="s1">&#39;XXXXXXXXXXXX&#39;</span><span class="p">,</span>
      <span class="nx">region</span><span class="o">:</span> <span class="s1">&#39;us-east-2&#39;</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div>

<p>Deploy the stack using the following command</p>
<div class="codehilite"><pre><span></span><code>cdk deploy
</code></pre></div>

<p>To confirm your team has been added to the cluster, run:</p>
<div class="codehilite"><pre><span></span><code>kubectl get ns team-awesome
</code></pre></div>

<h2 id="deploy-workloads-with-argocd">Deploy workloads with ArgoCD<a class="headerlink" href="#deploy-workloads-with-argocd" title="Permanent link">&para;</a></h2>
<p>Next, let's walk you through how to deploy workloads to your cluster with ArgoCD. This approach leverages the <a href="https://argoproj.github.io/argo-cd/operator-manual/cluster-bootstrapping/#app-of-apps-pattern">App of Apps</a> pattern to deploy multiple workloads arcoss multiple namespaces. The sample app of apps repository that we use in this walkthrough can be found <a href="https://github.com/kcoleman731/argo-apps.git">here</a>.</p>
<h3 id="install-argocd-cli">Install ArgoCD CLI<a class="headerlink" href="#install-argocd-cli" title="Permanent link">&para;</a></h3>
<p>Follow the instructions found <a href="https://argoproj.github.io/argo-cd/cli_installation/">here</a> as it will include instructions for your specific OS. You can test that the ArgoCD CLI was installed correctly using the following:</p>
<div class="codehilite"><pre><span></span><code>argocd version --short --client
</code></pre></div>

<p>You should see output similar to the following:</p>
<div class="codehilite"><pre><span></span><code><span class="n">argocd</span><span class="o">:</span> <span class="n">v2</span><span class="o">.</span><span class="mf">0.1</span><span class="o">+</span><span class="mi">33</span><span class="n">eaf11</span><span class="o">.</span><span class="na">dirty</span>
</code></pre></div>

<h3 id="exposing-argocd">Exposing ArgoCD<a class="headerlink" href="#exposing-argocd" title="Permanent link">&para;</a></h3>
<p>To access the ArgoCD running in your Kubernetes cluster, we simply need leverage port-forwarding.</p>
<p>To do so, first capture the service name in an environment variable.</p>
<div class="codehilite"><pre><span></span><code><span class="k">export</span> <span class="n">ARGO_SERVER</span><span class="o">=$</span><span class="p">(</span><span class="n">kubectl</span> <span class="n">get</span> <span class="n">svc</span> <span class="o">-</span><span class="n">n</span> <span class="n">argocd</span> <span class="o">-</span><span class="n">l</span> <span class="n">app</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">name</span><span class="o">=</span><span class="n">argocd</span><span class="o">-</span><span class="n">server</span> <span class="o">-</span><span class="n">o</span> <span class="n">name</span><span class="p">)</span> 
</code></pre></div>

<p>Next, in a new terminal tab, expose the service locally.</p>
<div class="codehilite"><pre><span></span><code>kubectl port-forward $ARGO_SERVER -n argocd 8080:443
</code></pre></div>

<p>Open your browser to http://localhost:8080 and you should see the Argo login screen.</p>
<h3 id="logging-into-argocd">Logging Into ArgoCD<a class="headerlink" href="#logging-into-argocd" title="Permanent link">&para;</a></h3>
<p>ArgoCD will create an <code>admin</code> user and password on a fresh install. To get the ArgoCD admin password, run the following.</p>
<div class="codehilite"><pre><span></span><code><span class="k">export</span> <span class="n">ARGO_PASSWORD</span><span class="o">=$</span><span class="p">(</span><span class="n">kubectl</span> <span class="o">-</span><span class="n">n</span> <span class="n">argocd</span> <span class="n">get</span> <span class="n">secret</span> <span class="n">argocd</span><span class="o">-</span><span class="n">initial</span><span class="o">-</span><span class="n">admin</span><span class="o">-</span><span class="n">secret</span> <span class="o">-</span><span class="n">o</span> <span class="n">jsonpath</span><span class="o">=</span><span class="s2">&quot;{.data.password}&quot;</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">)</span>
</code></pre></div>

<p>While still port-forwarding, login via the following.</p>
<div class="codehilite"><pre><span></span><code>argocd login localhost:8080 --username admin --password $ARGO_PASSWORD
</code></pre></div>

<h3 id="deploy-workloads-to-your-cluster">Deploy workloads to your cluster<a class="headerlink" href="#deploy-workloads-to-your-cluster" title="Permanent link">&para;</a></h3>
<p>Create a project in Argo by running the following command</p>
<div class="codehilite"><pre><span></span><code>argocd proj create sample \
    -d https://kubernetes.default.svc,argocd \
    -s https://github.com/kcoleman731/argo-apps.git
</code></pre></div>

<p>Create the application within Argo by running the following command</p>
<div class="codehilite"><pre><span></span><code>argocd app create sample-apps \
    --dest-namespace argocd  \
    --dest-server https://kubernetes.default.svc  \
    --repo https://github.com/kcoleman731/argo-apps.git \
    --path &quot;.&quot;
</code></pre></div>

<p>Sync the apps by running the following command</p>
<div class="codehilite"><pre><span></span><code>argocd app sync sample-apps 
</code></pre></div>

<h3 id="validate-deployments">Validate deployments.<a class="headerlink" href="#validate-deployments" title="Permanent link">&para;</a></h3>
<p>To validate your deployments, leverage kubectl port-forwarding to access the <code>guestbook-ui</code> service for <code>team-burnham</code>.</p>
<div class="codehilite"><pre><span></span><code>kubectl port-forward svc/guestbook-ui -n team-burnham 4040:80
</code></pre></div>

<p>Open up <code>localhost:4040</code> in your browser and you should see the application. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href=".." class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview
            </div>
          </div>
        </a>
      
      
        <a href="../teams/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Teams
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
    
  </body>
</html>